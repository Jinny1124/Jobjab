<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏Ñ‡πÄ‡∏Ñ‡∏≤‡∏ó‡πå</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../src/assets/styles/7accemplyee2.css" />
</head>
<body>
  <div class="container">
    <div class="left-panel">
      <div>
        <h1>‡∏™‡∏£‡πâ‡∏≤‡∏á<br />‡πÅ‡∏≠‡∏Ñ‡πÄ‡∏Ñ‡∏≤‡∏ó‡πå</h1>
        <p>(‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô)</p>
        <div class="steps">
          <div class="step done">‚úì ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</div>
          <div class="step done">‚úì ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</div>
        </div>
      </div>
      <div class="logo">JobJab</div>
    </div>

    <div class="right-panel">
      <a href="../components/4inhomepage.html" class="back-arrow">&#10094;</a>

      <!--‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ -->
      <div class="section">
        <div class="section-header">
          <h2>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h2>
        </div>
        <div class="input-group">
          <input type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤" id="edu-input" />
          <input type="text" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°" id="edu-desc" />
          <input type="text" placeholder="‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏µ (‡πÄ‡∏ä‡πà‡∏ô 2560 - 2564)" id="edu-year" />
        </div>
        <button onclick="addItem('edu')">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
        <div class="list" id="edu-list"></div>
      </div>

      <div class="section">
        <div class="section-header">
          <h2>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h2>
        </div>
        <div class="input-group">
          <input type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á" id="work-input" />
          <input type="text" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°" id="work-desc" />
          <input type="text" placeholder="‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏µ (‡πÄ‡∏ä‡πà‡∏ô 2560 - 2564)" id="work-year" />
        </div>
        <button onclick="addItem('work')">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
        <div class="list" id="work-list"></div>
      </div>

      <!-- ‡∏™‡∏ó‡∏±‡∏Å‡∏©‡∏∞ -->
      <div class="section">
        <div class="section-header">
          <h2>‡∏ó‡∏±‡∏Å‡∏©‡∏∞</h2>
        </div>
        <div class="input-group">
          <input type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏±‡∏Å‡∏©‡∏∞" id="skill-input" />
          <input type="text" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°" id="skill-desc" />
        </div>
        <button onclick="addItem('skill')">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
        <div class="list" id="skill-list"></div>
      </div>

      <button id="save-button" class="save-btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </div>
  </div>

  <script>
    function addItem(type) {
      const input = document.getElementById(`${type}-input`);
      const desc = document.getElementById(`${type}-desc`);
      const year = document.getElementById(`${type}-year`);
      const list = document.getElementById(`${type}-list`);
    
      const title = input.value.trim();
      const description = desc?.value.trim();
      const yearRange = year?.value.trim();
    
      if (!title) return;
    
      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
      const newItem = { title, desc: description, year: yearRange };
    
      // ‡∏≠‡πà‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏°‡∏à‡∏≤‡∏Å local
      const existing = JSON.parse(localStorage.getItem(`${type}-data`) || "[]");
    
      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ã‡∏ü‡∏Å‡∏•‡∏±‡∏ö
      existing.push(newItem);
      localStorage.setItem(`${type}-data`, JSON.stringify(existing));
    
      const div = document.createElement("div");
      div.className = "list-item";
      div.innerHTML = `
        <p><strong>${title}</strong></p>
        ${description ? `<p>${description}</p>` : ""}
        ${yearRange ? `<p>${yearRange}</p>` : ""}
        <span class="remove-btn" onclick="removeItem(this, '${type}', ${existing.length - 1})">√ó</span>
      `;
      list.appendChild(div);
    
      // ‡∏•‡πâ‡∏≤‡∏á input
      input.value = "";
      if (desc) desc.value = "";
      if (year) year.value = "";
      input.focus();
    }
    
    // ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï localStorage
    function removeItem(el, type, index) {
      const parent = el.parentElement;
      parent.remove();
    
      let data = JSON.parse(localStorage.getItem(`${type}-data`) || "[]");
      data.splice(index, 1);
      localStorage.setItem(`${type}-data`, JSON.stringify(data));
    
      //reload ‡∏ó‡∏±‡πâ‡∏á list ‡πÉ‡∏´‡∏°‡πà‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ sync ‡∏•‡∏≥‡∏î‡∏±‡∏ö index
    }
    
    // üéØ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå Enter
    ['edu', 'work', 'skill'].forEach(type => {
      ['input', 'desc', 'year'].forEach(field => {
        const el = document.getElementById(`${type}-${field}`);
        if (el) {
          el.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
              e.preventDefault();
              addItem(type);
            }
          });
        }
      });
    });
    
    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
    window.onload = function () {
      ['edu', 'work', 'skill'].forEach(type => {
        const list = document.getElementById(`${type}-list`);
        const data = JSON.parse(localStorage.getItem(`${type}-data`) || "[]");
        data.forEach((item, index) => {
          const div = document.createElement("div");
          div.className = "list-item";
          div.innerHTML = `
            <p><strong>${item.title}</strong></p>
            ${item.desc ? `<p>${item.desc}</p>` : ""}
            ${item.year ? `<p>${item.year}</p>` : ""}
            <span class="remove-btn" onclick="removeItem(this, '${type}', ${index})">√ó</span>
          `;
          list.appendChild(div);
        });
      });
    };
    
    document.getElementById("save-button").addEventListener("click", function () {
      // Retrieve data from localStorage
      const edu = JSON.parse(localStorage.getItem("edu-data") || "[]");
      const work = JSON.parse(localStorage.getItem("work-data") || "[]");
      const skill = JSON.parse(localStorage.getItem("skill-data") || "[]");
      const employeeProfile = JSON.parse(localStorage.getItem("employee-profile") || "{}");
    
      // Check if all required sections have at least one entry
      if (edu.length > 0 && work.length > 0 && skill.length > 0) {
        // Combine all data into a single object
        const completeProfile = {
          ...employeeProfile, // Include data from 6accemplyee.html
          education: edu,
          workExperience: work,
          skills: skill,
        };
    
        // Save the complete profile back to localStorage
        localStorage.setItem("employee-complete-profile", JSON.stringify(completeProfile));
        localStorage.setItem("employee-completed", "true");
    
        // Redirect to profile_user.html
        window.location.href = "../components/profile_user.html";
      } else {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å");
      }
    });
    </script>
    
</body>
</html>
